<!DOCTYPE html>
<html>
<head>
	<link href='https://fonts.googleapis.com/css?family=Orbitron' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="jquery.js"></script>
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>

</head>
<body>
	<div class="row">
		<div class="col s6">
			<div class="card pink darken-1">
				<div class="card-content white-text">
					<span class="card-title"> E (8:25 - 9:25)</span>
				</div>
			</div>
			<div class="card light-blue darken-1">
				<div class="card-content white-text">
					<span class="card-title"> Brunch (9:25 - 9:40)</span>
				</div>
			</div>
			<div class="card amber darken-1">
				<div class="card-content white-text">
					<span class="card-title"> B (9:40 - 10:55)</span>
				</div>
			</div>
			<div class="card blue darken-1">
				<div class="card-content white-text">
					<span class="card-title"> C ( 11:05 - 12:20)</span>
				</div>
			</div>
			<div class="card green darken-1">
				<div class="card-content white-text">
					<span class="card-title"> Lunch (12:20 - 1:00)</span>
				</div>
			</div>
			<div class="card deep-purple darken-1">
				<div class="card-content white-text">
					<span class="card-title"> A (1:30 - 2:15)</span>
				</div>
			</div> 
			<div class="card blue darken-1">
				<div class="card-content white-text">
					<span class="card-title"> G (2:25 - 3:40)</span>
				</div>
			</div> 
		</div>
		<div class="col s6">
			<div class="card blue lighten-2">
				<div class="card-content white-text">
					<span class="card-title">The Time</span>
					<span class="card-title"><h1><span id="clock"> 00:00 </span></h1></span>
				</div>
			</div>
			<div id="countdown-content">
				<div class="card red">
					<div class="card-content white-text">
						<span class="card-title"><h2>Go to class!!!!!!</h2></span>
				        <p id="countdown">0:00</p>
					</div>
				</div>
			</div>
			<div class="card blue">
				<div class="card-content white-text">
					<span class="card-title">News</span>
					<div class="card-action"></div>
			        <p>If you have news for the board contact Gunn Engineering!</p>
				</div>
			</div>
		</div>
	</div>



	<script>
		var check = true;
		var hidden = true;
		var timer;

		var starttime;
		var countdown = 60;
		var date = new Date();
		var currenttime = Date.now();
		var currentdate = date.getUTCMonth() + 1 + "-" + date.getUTCDate();

		var altschedules;
		var periodtimes;
		var schedule;

		//gets the alternate schedule list from the gunnwebapp
		getalternateschedules();



		function settimer(){
			document.getElementById("countdown-content").style.display = 'block';
			document.body.style.background = "#212121";
			starttime = Date.now();
			var timer = setInterval(function(){
				var done = updatetime();
				if(done) {
					clearInterval(timer);
					document.getElementById("countdown-content").style.display = 'none';
					document.body.style.background = "#FFFFFF";
				}
    		}, 13);
		}

		function updatetime(){
			currenttime = new Date();
			if(countdown > 0){
				countdown = parseFloat(60 - (currenttime.getSeconds()+currenttime.getMilliseconds()*0.001)).toFixed(2);
				document.getElementById("countdown").innerHTML = countdown;
				return false;
			}
			else {
				countdown = 0;
				return true;
			}
		}

		function parseschedule(res){
			schedule = res.split(/\r?\n/);
			console.log(schedule);
		}

		function addperiod(periodname){
			var div = document.createElement('div');
			div.setAttribute('class', 'period');
			document.getElementById("item-a").append(div);
		}

		function updateclock(){
			date = new Date();
			if(date.getMinutes() >= 10) {
				if(date.getHours <= 12) {
					document.getElementById("clock").innerHTML = date.getHours() + ":" + date.getMinutes();
				}
				else {
					document.getElementById("clock").innerHTML = date.getHours()%12 + ":" + date.getMinutes();
				}
			}
			else {
				if(date.getHours <= 12) {
					document.getElementById("clock").innerHTML = date.getHours() + ":0" + date.getMinutes();
				}
				else {
					document.getElementById("clock").innerHTML = date.getHours()%12 + ":0" + date.getMinutes();
				}
			}
			//checks if next 1 min before class & hidden
			if(countdowncheck(((date.getHours()%12)*100+date.getMinutes())+1)){
				settimer();
			}
		}

		//checks if time is at next period
		function countdowncheck(time){
			console.log(time);
			if(time==825 || time==945 || time==1155 || time==130){
				return true;
			}
			else return false;
		}

		function getalternateschedules(callback) {
		  	$.getJSON("https://orbiit.github.io/gunn-web-app/json/alt-schedules-2017-18-object.json", function(data){
				altschedules = data;
				console.log(altschedules);
				checkalternate();
			});
		}

		function checkalternate(){
			// console.log(altschedules);
			for(x in altschedules){
				if(true) {
					//call set schedule function with information from altschedules[x]
					setschedule(altschedules[x]);
					console.log(altschedules[x]);
					return;
				}
				else {
					//call set schedule function with date.getDay();
					setschedule(date.getDay());
				}
				console.log(x);
			}
		}

		function setschedule(day) {
			if(day==0 || day==7) {
				//set some var to false and display text saying no school
			}

			else if(day==1) {
				periodtimes = {
					"A": {"start":"8:25", "end":"9:45"},
					"Brunch": {"start":"9:45", "end":"10:00"},
					"B": {"start":"10:00", "end":"11:15"},
					"C": {"start":"11:25", "end":"12:40"},
					"Lunch": {"start":"12:40", "end":"1:20"},
					"F": {"start":"1:20", "end":"2:35"}
				}

				// "periods":[{"name":"C","start":{"totalminutes":505,"hour":8,"minute":25},"end":{"totalminutes":565,"hour":9,"minute":25}},{"name":"Brunch","start":{"totalminutes":565,"hour":9,"minute":25},"end":{"totalminutes":585,"hour":9,"minute":45}},{"name":"Flex","start":{"totalmin
			}
			else if(day==2) {
				periodtimes = {
					"A": {"start":"8:25", "end":"9:45"},
					"Brunch": {"start":"9:45", "end":"10:00"},
					"B": {"start":"10:00", "end":"11:15"},
					"C": {"start":"11:25", "end":"12:40"},
					"Lunch": {"start":"12:40", "end":"1:20"},
					"F": {"start":"1:20", "end":"2:35"}
				}

			}
			else if(day==3) {
				periodtimes = {
					"D": {"start":"8:25", "end":"9:45"},
					"Brunch": {"start":"9:45", "end":"10:00"},
					"Flex": {"start":"10:00", "end":"10:50"},
					"E": {"start":"11:00", "end":"12:15"},
					"Lunch": {"start":"12:15", "end":"12:55"},
					"A": {"start":"12:55", "end":"2:15"},
					"G": {"start":"2:25", "end":"3:40"}
				}

			}
			else if(day==4) {
				periodtimes = {
					"B": {"start":"8:25", "end":"9:50"},
					"Brunch": {"start":"9:50", "end":"10:05"},
					"C": {"start":"10:05", "end":"11:25"},
					"D": {"start":"11:35", "end":"12:55"},
					"Lunch": {"start":"12:55", "end":"1:35"},
					"F": {"start":"1:35", "end":"2:55"}
				}
			}
			else if(day==5) {
				periodtimes = {
					"E": {"start":"8:25", "end":"9:50"},
					"Brunch": {"start":"9:50", "end":"10:05"},
					"Flex": {"start":"10:05", "end":"10:55"},
					"B": {"start":"11:05", "end":"12:15"},
					"Lunch": {"start":"12:15", "end":"12:55"},
					"A": {"start":"12:55", "end":"2:05"},
					"G": {"start":"2:15", "end":"3:35"}
				}
			}
			else if(day==6) {
				periodtimes = {
					"C": {"start":"8:25", "end":"9:40"},
					"Brunch": {"start":"9:40", "end":"9:55"},
					"D": {"start":"9:55", "end":"11:05"},
					"C": {"start":"11:15", "end":"12:25"},
					"Lunch": {"start":"12:25", "end":"1:05"},
					"F": {"start":"1:05", "end":"2:15"},
					"G": {"start":"2:25", "end":"3:35"}
				}
			}
			else{
				console.log(day);
				var times = JSON.parse(day);
				console.log(times);
			}
		}

		function getalternatetimes(){

		}


		$.get({
			url: "http://kvfrans.com:8044/schedule.txt",
			type: 'GET',
			success: function(res) {
				parseschedule(res);
			}
		});

		// setInterval(countdowncheck, 30)
		setInterval(updateclock, 13);

		// hidecontent();
		</script>

</body>
</html>
